<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1651px" preserveAspectRatio="none" style="width:1340px;height:1651px;" version="1.1" viewBox="0 0 1340 1651" width="1340px" zoomAndPan="magnify"><defs><filter height="300%" id="f12wzdji8t8sgk" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[4a77e03bc18691b8919b6eaee68b6397]
cluster support--><polygon fill="#FFFFFF" filter="url(#f12wzdji8t8sgk)" points="30.5,102,182.5,102,189.5,124.4883,1023.5,124.4883,1023.5,256,30.5,256,30.5,102" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="30.5" x2="189.5" y1="124.4883" y2="124.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="34.5" y="117.5352">core.handler.support</text><!--MD5=[02ce43ee6c19eec9361f331a4e96450d]
cluster executor--><polygon fill="#FFFFFF" filter="url(#f12wzdji8t8sgk)" points="30.5,305,187.5,305,194.5,327.4883,577.5,327.4883,577.5,446,30.5,446,30.5,305" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="30.5" x2="194.5" y1="327.4883" y2="327.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="34.5" y="320.5352">core.handler.executor</text><!--MD5=[7f1db14b27b7629509c802e44e13c9c4]
cluster context--><polygon fill="#FFFFFF" filter="url(#f12wzdji8t8sgk)" points="30.5,495,179.5,495,186.5,517.4883,451.5,517.4883,451.5,1046,30.5,1046,30.5,495" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="30.5" x2="186.5" y1="517.4883" y2="517.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="143" x="34.5" y="510.5352">core.handler.context</text><!--MD5=[f12f832c3ac0603ce526ef171d08d9c6]
cluster base--><polygon fill="#FFFFFF" filter="url(#f12wzdji8t8sgk)" points="491.5,579,614.5,579,621.5,601.4883,915.5,601.4883,915.5,987.5,491.5,987.5,491.5,579" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="491.5" x2="621.5" y1="601.4883" y2="601.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="495.5" y="594.5352">core.handle.base</text><!--MD5=[5336d0432c5753478f8bb0248199b33b]
cluster handler--><polygon fill="#FFFFFF" filter="url(#f12wzdji8t8sgk)" points="229.5,1095,355.5,1095,362.5,1117.4883,1193.5,1117.4883,1193.5,1644,229.5,1644,229.5,1095" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="229.5" x2="362.5" y1="1117.4883" y2="1117.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="233.5" y="1110.5352">core.handler.http</text><!--MD5=[46f2c292e41020ccd6cfa91fa9d63f8f]
class Handlers--><rect codeLine="8" fill="#FEFECE" filter="url(#f12wzdji8t8sgk)" height="86.8652" id="Handlers" style="stroke:#A80036;stroke-width:1.5;" width="926" x="73.5" y="145"/><ellipse cx="506.25" cy="161" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M508.7231,167.1431 Q508.1421,167.4419 507.5029,167.5913 Q506.8638,167.7407 506.1582,167.7407 Q503.6514,167.7407 502.3315,166.0889 Q501.0117,164.437 501.0117,161.3159 Q501.0117,158.1865 502.3315,156.5347 Q503.6514,154.8828 506.1582,154.8828 Q506.8638,154.8828 507.5112,155.0322 Q508.1587,155.1816 508.7231,155.4805 L508.7231,158.2031 Q508.0923,157.6221 507.4988,157.3523 Q506.9053,157.0825 506.2744,157.0825 Q504.9297,157.0825 504.2449,158.1492 Q503.5601,159.2158 503.5601,161.3159 Q503.5601,163.4077 504.2449,164.4744 Q504.9297,165.541 506.2744,165.541 Q506.9053,165.541 507.4988,165.2712 Q508.0923,165.0015 508.7231,164.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="52" x="526.75" y="165.5352">Handlers</text><line style="stroke:#A80036;stroke-width:1.5;" x1="74.5" x2="998.5" y1="177" y2="177"/><line style="stroke:#A80036;stroke-width:1.5;" x1="74.5" x2="998.5" y1="185" y2="185"/><ellipse cx="84.5" cy="196" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="390" x="93.5" y="199.6348">static &lt;N extends Base&gt; AbstractHandler&lt;N&gt; createHandlerFor(N node)</text><ellipse cx="84.5" cy="208.9551" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="548" x="93.5" y="212.5898">static &lt;R&gt; R createSupportHandlerFor(Class&lt;? extends Base&gt; forNodeClass, Class&lt;?&gt; selectorClass)</text><ellipse cx="84.5" cy="221.9102" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="900" x="93.5" y="225.5449">static &lt;N extends Base&gt; AbstractHandler&lt;N&gt; createCompositionHandlerFor(N node, Class&lt;? extends Base&gt; forNodeClass, Class&lt;? extends Base&gt; selectorNodeClass)</text><!--MD5=[a0a1f7f9662f43ef0ece806266f72a6f]
class Executor--><rect codeLine="16" fill="#FEFECE" filter="url(#f12wzdji8t8sgk)" height="73.9102" id="Executor" style="stroke:#A80036;stroke-width:1.5;" width="480" x="73.5" y="348"/><ellipse cx="284.25" cy="364" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M286.7231,370.1431 Q286.1421,370.4419 285.5029,370.5913 Q284.8638,370.7407 284.1582,370.7407 Q281.6514,370.7407 280.3315,369.0889 Q279.0117,367.437 279.0117,364.3159 Q279.0117,361.1865 280.3315,359.5347 Q281.6514,357.8828 284.1582,357.8828 Q284.8638,357.8828 285.5112,358.0322 Q286.1587,358.1816 286.7231,358.4805 L286.7231,361.2031 Q286.0923,360.6221 285.4988,360.3523 Q284.9053,360.0825 284.2744,360.0825 Q282.9297,360.0825 282.2449,361.1492 Q281.5601,362.2158 281.5601,364.3159 Q281.5601,366.4077 282.2449,367.4744 Q282.9297,368.541 284.2744,368.541 Q284.9053,368.541 285.4988,368.2712 Q286.0923,368.0015 286.7231,367.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="50" x="304.75" y="368.5352">Executor</text><line style="stroke:#A80036;stroke-width:1.5;" x1="74.5" x2="552.5" y1="380" y2="380"/><line style="stroke:#A80036;stroke-width:1.5;" x1="74.5" x2="552.5" y1="388" y2="388"/><ellipse cx="84.5" cy="399" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="294" x="93.5" y="402.6348">static &lt;N extends Base&gt; Execution instanceOf(N node)</text><ellipse cx="84.5" cy="411.9551" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="454" x="93.5" y="415.5898">static &lt;N extends Base&gt; ExecutionContext execute(N node, ExecutionContext input)</text><!--MD5=[b8f9c9f402fdb0639661b25476f0741f]
class ExecutionContext--><rect codeLine="23" fill="#FEFECE" filter="url(#f12wzdji8t8sgk)" height="229.3711" id="ExecutionContext" style="stroke:#A80036;stroke-width:1.5;" width="354" x="73.5" y="538"/><ellipse cx="196.75" cy="554" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M199.2231,560.1431 Q198.6421,560.4419 198.0029,560.5913 Q197.3638,560.7407 196.6582,560.7407 Q194.1514,560.7407 192.8315,559.0889 Q191.5117,557.437 191.5117,554.3159 Q191.5117,551.1865 192.8315,549.5347 Q194.1514,547.8828 196.6582,547.8828 Q197.3638,547.8828 198.0112,548.0322 Q198.6587,548.1816 199.2231,548.4805 L199.2231,551.2031 Q198.5923,550.6221 197.9988,550.3523 Q197.4053,550.0825 196.7744,550.0825 Q195.4297,550.0825 194.7449,551.1492 Q194.0601,552.2158 194.0601,554.3159 Q194.0601,556.4077 194.7449,557.4744 Q195.4297,558.541 196.7744,558.541 Q197.4053,558.541 197.9988,558.2712 Q198.5923,558.0015 199.2231,557.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="99" x="217.25" y="558.5352">ExecutionContext</text><line style="stroke:#A80036;stroke-width:1.5;" x1="74.5" x2="426.5" y1="570" y2="570"/><ellipse cx="84.5" cy="581" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="93.5" y="584.6348">static ExecutionContext empty()</text><ellipse cx="84.5" cy="593.9551" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="277" x="93.5" y="597.5898">static ExecutionContext of(ExecutionContext input)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="74.5" x2="426.5" y1="603.9102" y2="603.9102"/><ellipse cx="84.5" cy="614.9102" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="311" x="93.5" y="618.5449">ExecutionContext join(ExecutionContext anotherContext)</text><ellipse cx="84.5" cy="627.8652" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="93.5" y="631.5">Services services()</text><ellipse cx="84.5" cy="640.8203" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="294" x="93.5" y="644.4551">ExecutionContext globalState(Object key, Object value)</text><ellipse cx="84.5" cy="653.7754" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="328" x="93.5" y="657.4102">&lt;R&gt; R globalStateIfAbsent(Object key, Supplier&lt;R&gt; supplier)</text><ellipse cx="84.5" cy="666.7305" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="93.5" y="670.3652">Map&lt;String, Object&gt; variables()</text><ellipse cx="84.5" cy="679.6855" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="93.5" y="683.3203">Object variable(String key)</text><ellipse cx="84.5" cy="692.6406" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="274" x="93.5" y="696.2754">ExecutionContext variable(String key, Object value)</text><ellipse cx="84.5" cy="705.5957" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="93.5" y="709.2305">ExecutionContext state(Object key, Object value)</text><ellipse cx="84.5" cy="718.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="147" x="93.5" y="722.1855">&lt;R&gt; R state(Class&lt;R&gt; key)</text><ellipse cx="84.5" cy="731.5059" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="128" x="93.5" y="735.1406">&lt;R&gt; R state(Object key)</text><ellipse cx="84.5" cy="744.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="154" x="93.5" y="748.0957">void releaseState(Object key)</text><ellipse cx="84.5" cy="757.416" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="281" x="93.5" y="761.0508">ExecutionContext merge(ExecutionContext context)</text><!--MD5=[456b5dcdd3523bcda4108ba1c5f6c640]
class ExecutionContext.Builder--><rect codeLine="41" fill="#FEFECE" filter="url(#f12wzdji8t8sgk)" height="177.5508" id="ExecutionContext.Builder" style="stroke:#A80036;stroke-width:1.5;" width="311" x="95" y="844"/><ellipse cx="174.75" cy="860" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M177.2231,866.1431 Q176.6421,866.4419 176.0029,866.5913 Q175.3638,866.7407 174.6582,866.7407 Q172.1514,866.7407 170.8315,865.0889 Q169.5117,863.437 169.5117,860.3159 Q169.5117,857.1865 170.8315,855.5347 Q172.1514,853.8828 174.6582,853.8828 Q175.3638,853.8828 176.0112,854.0322 Q176.6587,854.1816 177.2231,854.4805 L177.2231,857.2031 Q176.5923,856.6221 175.9988,856.3523 Q175.4053,856.0825 174.7744,856.0825 Q173.4297,856.0825 172.7449,857.1492 Q172.0601,858.2158 172.0601,860.3159 Q172.0601,862.4077 172.7449,863.4744 Q173.4297,864.541 174.7744,864.541 Q175.4053,864.541 175.9988,864.2712 Q176.5923,864.0015 177.2231,863.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="143" x="195.25" y="864.5352">ExecutionContext.Builder</text><line style="stroke:#A80036;stroke-width:1.5;" x1="96" x2="405" y1="876" y2="876"/><line style="stroke:#A80036;stroke-width:1.5;" x1="96" x2="405" y1="884" y2="884"/><ellipse cx="106" cy="895" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="183" x="115" y="898.6348">Builder services(Services services)</text><ellipse cx="106" cy="907.9551" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="219" x="115" y="911.5898">Builder services(ExecutionContext input)</text><ellipse cx="106" cy="920.9102" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="285" x="115" y="924.5449">Builder globalState(Map&lt;Object, Object&gt; globalState)</text><ellipse cx="106" cy="933.8652" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="115" y="937.5">Builder globalState(ExecutionContext input)</text><ellipse cx="106" cy="946.8203" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="260" x="115" y="950.4551">Builder variables(Map&lt;String, Object&gt; variables)</text><ellipse cx="106" cy="959.7754" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="115" y="963.4102">Builder variables(ExecutionContext input)</text><ellipse cx="106" cy="972.7305" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="219" x="115" y="976.3652">Builder state(Map&lt;Object, Object&gt; state)</text><ellipse cx="106" cy="985.6855" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="115" y="989.3203">Builder state(ExecutionContext input)</text><ellipse cx="106" cy="998.6406" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="115" y="1002.2754">Builder of(ExecutionContext input)</text><ellipse cx="106" cy="1011.5957" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="115" y="1015.2305">ExecutionContext build()</text><!--MD5=[c38b041ce756cbe16ae0cf6e4cd53481]
class Execution--><rect codeLine="58" fill="#FEFECE" filter="url(#f12wzdji8t8sgk)" height="60.9551" id="Execution" style="stroke:#A80036;stroke-width:1.5;" width="315" x="550" y="622"/><ellipse cx="675.75" cy="638" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M672.1777,634.2651 L672.1777,632.1069 L679.5571,632.1069 L679.5571,634.2651 L677.0918,634.2651 L677.0918,642.3418 L679.5571,642.3418 L679.5571,644.5 L672.1777,644.5 L672.1777,642.3418 L674.6431,642.3418 L674.6431,634.2651 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="55" x="696.25" y="642.5352">Execution</text><line style="stroke:#A80036;stroke-width:1.5;" x1="551" x2="864" y1="654" y2="654"/><line style="stroke:#A80036;stroke-width:1.5;" x1="551" x2="864" y1="662" y2="662"/><ellipse cx="561" cy="673" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="289" x="570" y="676.6348">ExecutionContext execute(ExecutionContext context)</text><!--MD5=[01b95d182fe8d23fc8b232b64dd5b18e]
class AbstractHandler--><rect codeLine="62" fill="#FEFECE" filter="url(#f12wzdji8t8sgk)" height="60.9551" id="AbstractHandler" style="stroke:#A80036;stroke-width:1.5;" width="368" x="523.5" y="902.5"/><ellipse cx="609.25" cy="918.5" fill="#A9DCDF" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M609.1133,913.8481 L607.9595,918.9199 L610.2754,918.9199 Z M607.6191,911.6069 L610.6157,911.6069 L613.9609,924 L611.5122,924 L610.7485,920.937 L607.4697,920.937 L606.7227,924 L604.2739,924 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="94" x="629.75" y="923.0352">AbstractHandler</text><rect fill="#FFFFFF" height="16.1328" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="92" x="802.5" y="899.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="90" x="803.5" y="912.1016">N extends Base</text><line style="stroke:#A80036;stroke-width:1.5;" x1="524.5" x2="890.5" y1="934.5" y2="934.5"/><line style="stroke:#A80036;stroke-width:1.5;" x1="524.5" x2="890.5" y1="942.5" y2="942.5"/><polygon fill="#4177AF" points="534.5,949.5,530.5,955.5,538.5,955.5" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="342" x="543.5" y="957.1348">ExecutionContext configureContext(ExecutionContext context)</text><!--MD5=[f2f72a8a22143fdabb500f8432b91e61]
class AbstractNodeHandler--><rect codeLine="76" fill="#FEFECE" filter="url(#f12wzdji8t8sgk)" height="60.9551" id="AbstractNodeHandler" style="stroke:#A80036;stroke-width:1.5;" width="262" x="576.5" y="1138"/><ellipse cx="591.5" cy="1154" fill="#A9DCDF" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M591.3633,1149.3481 L590.2095,1154.4199 L592.5254,1154.4199 Z M589.8691,1147.1069 L592.8657,1147.1069 L596.2109,1159.5 L593.7622,1159.5 L592.9985,1156.437 L589.7197,1156.437 L588.9727,1159.5 L586.5239,1159.5 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="125" x="605.5" y="1158.5352">AbstractNodeHandler</text><rect fill="#FFFFFF" height="16.1328" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="103" x="738.5" y="1135"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="93" x="743.5" y="1147.6016">T extends Node</text><line style="stroke:#A80036;stroke-width:1.5;" x1="577.5" x2="837.5" y1="1170" y2="1170"/><line style="stroke:#A80036;stroke-width:1.5;" x1="577.5" x2="837.5" y1="1178" y2="1178"/><ellipse cx="587.5" cy="1189" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="596.5" y="1192.6348">AbstractNodeHandler(T node)</text><!--MD5=[ae82d90ea9f28f9a75f5a462d4509c47]
class OperationHandler--><rect codeLine="79" fill="#FEFECE" filter="url(#f12wzdji8t8sgk)" height="198.5059" id="OperationHandler" style="stroke:#A80036;stroke-width:1.5;" width="908" x="253.5" y="1260"/><ellipse cx="590.25" cy="1276" fill="#A9DCDF" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M590.1133,1271.3481 L588.9595,1276.4199 L591.2754,1276.4199 Z M588.6191,1269.1069 L591.6157,1269.1069 L594.9609,1281.5 L592.5122,1281.5 L591.7485,1278.437 L588.4697,1278.437 L587.7227,1281.5 L585.2739,1281.5 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="610.75" y="1280.5352">OperationHandler</text><rect fill="#FFFFFF" height="16.1328" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="121" x="1043.5" y="1257"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="119" x="1044.5" y="1269.6016">T extends Operation</text><line style="stroke:#A80036;stroke-width:1.5;" x1="254.5" x2="1160.5" y1="1292" y2="1292"/><polygon fill="#4177AF" points="264.5,1299,260.5,1305,268.5,1305" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="555" x="273.5" y="1306.6348">static void copyInputHeadersToRequestBuilder(ExecutionContext input, Request.Builder requestBuilder)</text><polygon fill="#4177AF" points="264.5,1311.9551,260.5,1317.9551,268.5,1317.9551" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="658" x="273.5" y="1319.5898">static void copyNodeHeadersToRequestBuilder(Operation node, ExecutionContext context, Request.Builder requestBuilder)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="254.5" x2="1160.5" y1="1325.9102" y2="1325.9102"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="261.5" y="1333.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="250" x="273.5" y="1340.5449">String evaluatedUrl(ExecutionContext context)</text><polygon fill="#4177AF" points="264.5,1345.8652,260.5,1351.8652,268.5,1351.8652" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="230" x="273.5" y="1353.5">int beforeRequest(ExecutionContext input)</text><polygon fill="#4177AF" points="264.5,1358.8203,260.5,1364.8203,268.5,1364.8203" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="525" x="273.5" y="1366.4551">Response doRequest(ExecutionContext input, int requestTimeout, Request.Builder requestBuilder)</text><polygon fill="#4177AF" points="264.5,1371.7754,260.5,1377.7754,268.5,1377.7754" style="stroke:#1963A0;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="433" x="273.5" y="1379.4102">ExecutionContext handleResponse(ExecutionContext input, Response response)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="261.5" y="1385.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="882" x="273.5" y="1392.3652">private Response sendAndRetryRequestOnError(ExecutionContext context, Client client, Request request, int requestTimeout, int retryCount, int napOnRetryInMillis)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="261.5" y="1398.6855"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="742" x="273.5" y="1405.3203">private Response executeRequest(ExecutionContext context, Client client, Request request, int requestTimeout, boolean inRetryWhileState)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="261.5" y="1411.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="511" x="273.5" y="1418.2754">private void validateResponse(ExecutionContext context, Request request, Response response)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="261.5" y="1424.5957"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="273.5" y="1431.2305">private void nap(int millis)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="254.5" x2="1160.5" y1="1437.5508" y2="1437.5508"/><ellipse cx="264.5" cy="1448.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="289" x="273.5" y="1452.1855">ExecutionContext execute(ExecutionContext context)</text><!--MD5=[b9b8c6612922766dbf3276cb0fc8b2c2]
class GetHandler--><rect codeLine="94" fill="#FEFECE" filter="url(#f12wzdji8t8sgk)" height="99.8203" id="GetHandler" style="stroke:#A80036;stroke-width:1.5;" width="302" x="556.5" y="1520"/><ellipse cx="654.25" cy="1536" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M656.7231,1542.1431 Q656.1421,1542.4419 655.5029,1542.5913 Q654.8638,1542.7407 654.1582,1542.7407 Q651.6514,1542.7407 650.3315,1541.0889 Q649.0117,1539.437 649.0117,1536.3159 Q649.0117,1533.1865 650.3315,1531.5347 Q651.6514,1529.8828 654.1582,1529.8828 Q654.8638,1529.8828 655.5112,1530.0322 Q656.1587,1530.1816 656.7231,1530.4805 L656.7231,1533.2031 Q656.0923,1532.6221 655.4988,1532.3523 Q654.9053,1532.0825 654.2744,1532.0825 Q652.9297,1532.0825 652.2449,1533.1492 Q651.5601,1534.2158 651.5601,1536.3159 Q651.5601,1538.4077 652.2449,1539.4744 Q652.9297,1540.541 654.2744,1540.541 Q654.9053,1540.541 655.4988,1540.2712 Q656.0923,1540.0015 656.7231,1539.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="66" x="674.75" y="1540.5352">GetHandler</text><rect fill="#FFFFFF" height="16.1328" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="30" x="831.5" y="1517"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="20" x="836.5" y="1529.6016">Get</text><line style="stroke:#A80036;stroke-width:1.5;" x1="557.5" x2="857.5" y1="1552" y2="1552"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="167" x="562.5" y="1566.6348">@Handler(forClass = Get.class)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="557.5" x2="857.5" y1="1572.9551" y2="1572.9551"/><ellipse cx="567.5" cy="1583.9551" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="576.5" y="1587.5898">GetHandler(Get node)</text><ellipse cx="567.5" cy="1596.9102" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="276" x="576.5" y="1600.5449">ExecutionContext execute(ExecutionContext input)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="579.5" y="1613.5"/><path d="M6,6 L6,46.6211 L71,46.6211 L71,16 L61,6 L6,6 " fill="#FBFB77" filter="url(#f12wzdji8t8sgk)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M61,6 L61,16 L71,16 L61,6 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="12" y="23.5684">asdasd</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="12" y="38.8789">asdasd</text><path d="M1040,889.5 L1040,976.0527 L1331,976.0527 L1331,899.5 L1321,889.5 L1040,889.5 " fill="#FBFB77" filter="url(#f12wzdji8t8sgk)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1321,889.5 L1321,899.5 L1331,899.5 L1321,889.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="1046" y="907.0684">The Handler pattern is ubiquitous to all</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="1046" y="922.3789">descendents of</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="28" x="1146" y="922.3789">Base</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="1178" y="922.3789">interfaces.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1050" y="937.6895"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="270" x="1046" y="953">This example demonstrates use of Handler</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="1046" y="968.3105">for a Http Get operation.</text><!--MD5=[19aee03508efa9a4bec6989d1c9b1e2b]
link GMN279 to support--><path d="M38.5,47.12 C38.5,57.635 38.5,71.4762 38.5,86.3698 C38.5,90.0932 38.5,93.8824 38.5,97.7018 C38.5,98.6567 38.5,99.6134 38.5,100.5715 C38.5,100.811 38.5,101.0506 38.5,101.2903 " fill="none" id="GMN279-support" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><!--MD5=[d871a3de79db30f55418a7c0f52ed8aa]
reverse link ExecutionContext to ExecutionContext.Builder--><path codeLine="54" d="M250.5,772.29 C250.5,796.29 250.5,821.12 250.5,843.85 " fill="none" id="ExecutionContext-backto-ExecutionContext.Builder" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="250.5,767.18,246.5,776.18,250.5,772.18,254.5,776.18,250.5,767.18" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="255.5" y="810.5684">build()</text><!--MD5=[adf5fab647bad8347ea1c469a201606b]
reverse link Execution to AbstractHandler--><path d="M707.5,703.31 C707.5,761.2 707.5,854.85 707.5,902.34 " fill="none" id="Execution-backto-AbstractHandler" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="700.5,703.04,707.5,683.04,714.5,703.04,700.5,703.04" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[feec1edb36cedbcbacb5f46645d4c5da]
link GMN294 to handler--><path d="M1185.5,976.56 C1185.5,993.1325 1185.5,1013.1119 1185.5,1033.8177 C1185.5,1044.1705 1185.5,1054.705 1185.5,1065.0861 C1185.5,1070.2766 1185.5,1075.4287 1185.5,1080.5007 C1185.5,1083.0366 1185.5,1085.5525 1185.5,1088.0431 C1185.5,1089.2884 1185.5,1090.5274 1185.5,1091.7594 C1185.5,1092.3754 1185.5,1092.9896 1185.5,1093.602 C1185.5,1093.9082 1185.5,1094.214 1185.5,1094.5193 " fill="none" id="GMN294-handler" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><!--MD5=[2551c99dc05230a95e7a969f69833701]
reverse link AbstractHandler to AbstractNodeHandler--><path codeLine="102" d="M707.5,983.65 C707.5,1030.44 707.5,1098.98 707.5,1137.8 " fill="none" id="AbstractHandler-backto-AbstractNodeHandler" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="700.5,983.57,707.5,963.57,714.5,983.57,700.5,983.57" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[d5bfa55a1b30530b4ef88ab29c2aac9c]
reverse link AbstractNodeHandler to OperationHandler--><path codeLine="103" d="M707.5,1219.32 C707.5,1231.92 707.5,1245.89 707.5,1259.99 " fill="none" id="AbstractNodeHandler-backto-OperationHandler" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="700.5,1219.03,707.5,1199.03,714.5,1219.03,700.5,1219.03" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[7750d886bb0e7a03892349d41225d540]
reverse link OperationHandler to GetHandler--><path codeLine="104" d="M707.5,1479.46 C707.5,1493.66 707.5,1507.49 707.5,1519.86 " fill="none" id="OperationHandler-backto-GetHandler" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="700.5,1479.25,707.5,1459.25,714.5,1479.25,700.5,1479.25" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[d7a43a844b5551980fba41313981cbb1]
link support to executor--><!--MD5=[c23434db23b374fa636b7f6f72b8891e]
link executor to context--><!--MD5=[69b35cefe71ca946e981b026470c02fb]
link context to base--><!--MD5=[960b4dbbd8935d0f2ee0d88d7fb5c210]
@startuml

note top of support
asdasd
asdasd
end note

package "core.handler.support" as support {
    class Handlers {
        +static <N extends Base> AbstractHandler<N> createHandlerFor(N node)
        +static <R> R createSupportHandlerFor(Class<? extends Base> forNodeClass, Class<?> selectorClass)
        +static <N extends Base> AbstractHandler<N> createCompositionHandlerFor(N node, Class<? extends Base> forNodeClass, Class<? extends Base> selectorNodeClass)
    }
}

package "core.handler.executor" as executor {
    class Executor {
        +static <N extends Base> Execution instanceOf(N node)
        +static <N extends Base> ExecutionContext execute(N node, ExecutionContext input)
    }
}

package "core.handler.context" as context {
    class ExecutionContext {
        +static ExecutionContext empty()
        +static ExecutionContext of(ExecutionContext input)
        - -
        +ExecutionContext join(ExecutionContext anotherContext)
        +Services services()
        +ExecutionContext globalState(Object key, Object value)
        +<R> R globalStateIfAbsent(Object key, Supplier<R> supplier)
        +Map<String, Object> variables()
        +Object variable(String key)
        +ExecutionContext variable(String key, Object value)
        +ExecutionContext state(Object key, Object value)
        +<R> R state(Class<R> key)
        +<R> R state(Object key)
        +void releaseState(Object key)
        +ExecutionContext merge(ExecutionContext context)
    }

    class ExecutionContext.Builder {
        +Builder services(Services services)
        +Builder services(ExecutionContext input)
        +Builder globalState(Map<Object, Object> globalState)
        +Builder globalState(ExecutionContext input)
        +Builder variables(Map<String, Object> variables)
        +Builder variables(ExecutionContext input)
        +Builder state(Map<Object, Object> state)
        +Builder state(ExecutionContext input)
        +Builder of(ExecutionContext input)
        +ExecutionContext build()
    }

    ExecutionContext <.. ExecutionContext.Builder : " build()"
}

package "core.handle.base" as base {
    interface Execution {
        +ExecutionContext execute(ExecutionContext context)
    }

    abstract class AbstractHandler<N extends Base> implements Execution {
        ~ExecutionContext configureContext(ExecutionContext context)
    }
}

note top of handler
The Handler pattern is ubiquitous to all
descendents of <i>Base</i> interfaces.

This example demonstrates use of Handler
for a Http Get operation.
end note

package "core.handler.http" as handler {
    abstract class AbstractNodeHandler < T extends Node > {
        +AbstractNodeHandler(T node)
    }
    abstract class OperationHandler<T extends Operation> {
        ~static void copyInputHeadersToRequestBuilder(ExecutionContext input, Request.Builder requestBuilder)
        ~static void copyNodeHeadersToRequestBuilder(Operation node, ExecutionContext context, Request.Builder requestBuilder)
        - -
        -String evaluatedUrl(ExecutionContext context)
        ~int beforeRequest(ExecutionContext input)
        ~Response doRequest(ExecutionContext input, int requestTimeout, Request.Builder requestBuilder)
        ~ExecutionContext handleResponse(ExecutionContext input, Response response)
        -private Response sendAndRetryRequestOnError(ExecutionContext context, Client client, Request request, int requestTimeout, int retryCount, int napOnRetryInMillis)
        -private Response executeRequest(ExecutionContext context, Client client, Request request, int requestTimeout, boolean inRetryWhileState)
        -private void validateResponse(ExecutionContext context, Request request, Response response)
        -private void nap(int millis)
        - -
        +ExecutionContext execute(ExecutionContext context)
    }
    class GetHandler < Get > {
        @Handler(forClass = Get.class)
        - -
        +GetHandler(Get node)
        +ExecutionContext execute(ExecutionContext input)

    }

    AbstractNodeHandler -u-|> AbstractHandler
    OperationHandler -u-|> AbstractNodeHandler
    GetHandler -u-|> OperationHandler
}

support -[hidden]- executor
executor -[hidden]- context
context -[hidden] base

@enduml

PlantUML version 1.2020.26(Mon Dec 21 18:45:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: NO
--></g></svg>